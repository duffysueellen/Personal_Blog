<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sue-Ellen Duffy">
<meta name="dcterms.date" content="2024-05-03">

<title>Social_Networks_Blog_Space - POST 7</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="../../site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="../../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="../../site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="../../site_libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="../../site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="../../site_libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Social_Networks_Blog_Space</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">POST 7</h1>
            <p class="subtitle lead">Network Block Modeling - Geographical Comparisson</p>
                                <div class="quarto-categories">
                <div class="quarto-category">code</div>
                <div class="quarto-category">analysis</div>
                <div class="quarto-category">block_model</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Sue-Ellen Duffy </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 3, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sna)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(intergraph)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tigris)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stplanr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This post will explore the Block Modeling attributes with emphasis on geographical comparison. Including maps!</p>
<section id="read-in-data" class="level1">
<h1>Read in Data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pat_attr <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"post5drug_data/pat_attr.csv"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">...1 =</span> <span class="fu">col_skip</span>()))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>pro_attr <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"post5drug_data/pro_attr.csv"</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">...1 =</span> <span class="fu">col_skip</span>()))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>encounters_cleaning <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"post5drug_data//encounters_cleaning.csv"</span>, </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">...1 =</span> <span class="fu">col_skip</span>()))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>encounters_cleaned <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"post5drug_data//encounters_cleaned.csv"</span>, </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">...1 =</span> <span class="fu">col_skip</span>()))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>encounter_attributes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"post5drug_data/encounter_attributes.csv"</span>, </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">...1 =</span> <span class="fu">col_skip</span>()))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>encounters_el  <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"post5drug_data/encounters_el.csv"</span>, </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">...1 =</span> <span class="fu">col_skip</span>()))</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>encounters_st_3 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"post5drug_data/encounters.st.3.csv"</span>, </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">...1 =</span> <span class="fu">col_skip</span>()))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>attribute_list <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"post5drug_data/attribute_list.csv"</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>pat_blks6 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"pat_blks6_results.rds"</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>prov_blks6 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"prov_blks6_results.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-bipartite-network-with-attributes" class="level1">
<h1>Create bipartite network with attributes</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>encounters.stat <span class="ot">&lt;-</span> <span class="fu">network</span>(encounters_el,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">directed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bipartite =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">matrix.type =</span> <span class="st">"edgelist"</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">vertex.attr =</span> attribute_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create igraph</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>encounters.ig <span class="ot">&lt;-</span> <span class="fu">graph_from_biadjacency_matrix</span>(encounters.stat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>encounters.stat2 <span class="ot">&lt;-</span> <span class="fu">asNetwork</span>(encounters.ig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>projected_graph <span class="ot">&lt;-</span> <span class="fu">bipartite_projection</span>(encounters.ig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="provider" class="level2">
<h2 class="anchored" data-anchor-id="provider">PROVIDER</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>provider_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">as_adjacency_matrix</span>(projected_graph<span class="sc">$</span>proj2))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(intergraph)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">"package:igraph"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statnet)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>provider.stat <span class="ot">&lt;-</span> <span class="fu">asNetwork</span>(projected_graph<span class="sc">$</span>proj2)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>provider.se <span class="ot">&lt;-</span> <span class="fu">equiv.clust</span>(provider_matrix,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a> <span class="at">equiv.fun =</span> <span class="st">"sedist"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a> <span class="at">method =</span> <span class="st">"hamming"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a> <span class="at">mode =</span> <span class="st">"graph"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a> <span class="at">cluster.method =</span> <span class="st">"complete"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>blk_model.provider.org <span class="ot">&lt;-</span> <span class="fu">blockmodel</span>(provider_matrix,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a> provider.se, <span class="at">k =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>prov_blks6 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"prov_blks6_results.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># blockmodel with optimized partition</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>prov_blk_mod <span class="ot">&lt;-</span> <span class="fu">blockmodel</span>(provider_matrix, prov_blks6<span class="sc">$</span>best<span class="sc">$</span>best1<span class="sc">$</span>clu,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">plabels =</span> <span class="fu">rownames</span>(provider_matrix))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#assign block membership to vertex attribute</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>provider.stat<span class="sc">%v%</span><span class="st">"role"</span><span class="ot">&lt;-</span>prov_blk_mod<span class="sc">$</span>block.membership[<span class="fu">match</span>(provider.stat<span class="sc">%v%</span><span class="st">"vertex.names"</span>,prov_blk_mod<span class="sc">$</span>plabels)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>attributes <span class="ot">&lt;-</span> <span class="fu">dumpAttr</span>(provider.stat)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting roles and vertex names</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>roles <span class="ot">&lt;-</span> attributes<span class="sc">$</span>vertex<span class="sc">$</span>role</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>vertex_names <span class="ot">&lt;-</span> attributes<span class="sc">$</span>vertex<span class="sc">$</span>vertex.names</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a dataframe</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>role_vertex_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">vertex.names =</span> vertex_names, <span class="at">role =</span> roles)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the first few rows of the dataframe</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(role_vertex_df <span class="sc">%&gt;%</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(vertex.names)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            vertex.names role
1      Zachery872 Rau926    1
2    Zachery872 Pagac496    3
3     Waylon572 Lakin515    3
4     Virgen207 Hyatt152    5
5 Vicente970 Armstrong51    5
6      Vern731 Casper496    3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pro_attr <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(NAME)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  NAME                   GENDER CITY       type     block
  &lt;chr&gt;                  &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;
1 Zachery872 Rau926      Male   walpole    PROVIDER     1
2 Zachery872 Pagac496    Male   melrose    PROVIDER     3
3 Waylon572 Lakin515     Male   woburn     PROVIDER     3
4 Virgen207 Hyatt152     Female stoneham   PROVIDER     5
5 Vicente970 Armstrong51 Male   stoneham   PROVIDER     5
6 Vern731 Casper496      Male   swampscott PROVIDER     3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting vertex attributes</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>vertex_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">role =</span> <span class="fu">get.vertex.attribute</span>(provider.stat, <span class="st">"role"</span>),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertex.names =</span> <span class="fu">get.vertex.attribute</span>(provider.stat, <span class="st">"vertex.names"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Displaying the first few rows of the dataframe</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(vertex_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  role              vertex.names
1    3        Elijah719 White193
2    3         Fidel864 Swift555
3    5        Virgen207 Hyatt152
4    3       Zachery872 Pagac496
5    3 Kristopher775 Schiller186
6    3        Laine739 Torphy630</code></pre>
</div>
</div>
<p>#So, lets geographically map this network</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'leaflet' was built under R version 4.3.3</code></pre>
</div>
</div>
<p>#add lat and lon back into the attributes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(encounters_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 51
  ENCOUNTER_ID    START               STOP                PATIENT ORGANIZATION.x
  &lt;chr&gt;           &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;   &lt;chr&gt;         
1 1b544ceb-bfe9-… 2000-11-11 13:33:09 2000-11-11 14:33:09 Annice… db28cc9a-fdfb…
2 0d642d81-9624-… 2001-03-30 13:33:09 2001-03-30 14:33:09 Annice… db28cc9a-fdfb…
3 99d190e1-6727-… 2001-11-28 13:33:09 2001-11-28 14:33:09 Annice… db28cc9a-fdfb…
4 cc076374-d33d-… 2004-09-03 13:33:09 2004-09-03 14:31:19 Annice… 3d5fbf38-c781…
5 05a24332-4d5a-… 2005-09-09 13:33:09 2005-09-09 14:16:34 Annice… 3d5fbf38-c781…
6 8844f58d-3e5e-… 2008-09-12 13:33:09 2008-09-12 14:28:22 Annice… 3d5fbf38-c781…
# ℹ 46 more variables: PROVIDER &lt;chr&gt;, PAYER &lt;chr&gt;, ENCOUNTERCLASS &lt;chr&gt;,
#   CODE &lt;dbl&gt;, DESCRIPTION &lt;chr&gt;, BASE_ENCOUNTER_COST &lt;dbl&gt;,
#   TOTAL_CLAIM_COST &lt;dbl&gt;, PAYER_COVERAGE &lt;dbl&gt;, REASONCODE &lt;dbl&gt;,
#   REASONDESCRIPTION &lt;chr&gt;, ORGANIZATION.y &lt;chr&gt;, GENDER.x &lt;chr&gt;,
#   SPECIALITY &lt;chr&gt;, ADDRESS.x &lt;chr&gt;, CITY.x &lt;chr&gt;, STATE.x &lt;chr&gt;,
#   ZIP.x &lt;chr&gt;, LAT.x &lt;dbl&gt;, LON.x &lt;dbl&gt;, ENCOUNTERS &lt;dbl&gt;, PROCEDURES &lt;dbl&gt;,
#   BIRTHDATE &lt;date&gt;, DEATHDATE &lt;date&gt;, SSN &lt;chr&gt;, DRIVERS &lt;chr&gt;, …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df_reconnected <span class="ot">&lt;-</span> <span class="fu">merge</span>(pro_attr, encounters_cleaned, <span class="at">by.x =</span> <span class="st">"NAME"</span>, <span class="at">by.y =</span> <span class="st">"PROVIDER"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>df_coords<span class="ot">&lt;-</span> df_reconnected</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df_coords <span class="ot">&lt;-</span> df_coords <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(NAME, GENDER, CITY, type, block, LAT.x, LON.x) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(NAME)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only one row of each unique "NAME"</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>df_coords <span class="ot">&lt;-</span> df_coords <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(NAME, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">LAT =</span> LAT.x) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">LON =</span> LON.x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the resulting dataframe</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_coords)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
# Groups:   NAME [6]
  NAME                GENDER CITY          type     block   LAT   LON
  &lt;chr&gt;               &lt;chr&gt;  &lt;chr&gt;         &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Abdul218 Boyer713   Male   needham       PROVIDER     3  42.3 -71.2
2 Adán600 Alicea505   Male   centerville   PROVIDER     3  41.6 -70.3
3 Agnes294 Dooley940  Female fall river    PROVIDER     3  41.7 -71.1
4 Alberto639 Adame662 Male   saugus        PROVIDER     6  42.5 -71.0
5 Allyson474 Doyle959 Female west yarmouth PROVIDER     5  41.7 -70.2
6 Almeta56 Lehner980  Female greenfield    PROVIDER     5  42.6 -72.6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pat_df_coords <span class="ot">&lt;-</span> df_reconnected <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(PATIENT, GENDER.y, RACE, CITY.y,  LAT.y, LON.y) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(PATIENT)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only one row of each unique "NAME"</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>pat_df_coords <span class="ot">&lt;-</span> pat_df_coords <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">NAME =</span> PATIENT) <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(NAME, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">CITY =</span> CITY.y) <span class="sc">%&gt;%</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">GENDER =</span> GENDER.y) <span class="sc">%&gt;%</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">LAT =</span> LAT.y) <span class="sc">%&gt;%</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">LON =</span> LON.y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pat_df_coords)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
# Groups:   NAME [6]
  NAME                    GENDER RACE  CITY            LAT   LON
  &lt;chr&gt;                   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;
1 Dinorah501 Bechtelar572 Female white newton         42.3 -71.3
2 Cherise743 Prosacco716  Female white newton         42.3 -71.2
3 Rod343 Prosacco716      Male   white east sandwich  41.7 -70.4
4 Chaya236 Sporer811      Female asian fall river     41.6 -71.1
5 Leonel449 Witting912    Male   white lynn           42.5 -71.0
6 Rudy520 Hettinger594    Male   white yarmouth port  41.7 -70.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pat_df_coords<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"PATIENT"</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>pat_attr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 86 × 9
   NAME                   GENDER RACE  MARITAL  CITY    INCOME   AGE type  block
   &lt;chr&gt;                  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
 1 Annice210 Gleason633   Female white Married  brookl…   1565    37 PATI…     6
 2 Julianne852 Barrows492 Female white Widowed  hamilt…  39537    65 PATI…     6
 3 Alesha810 Heaney114    Female white Divorced framin… 114339    46 PATI…     6
 4 Sandee884 Rice937      Female white &lt;NA&gt;     taunton  96256    26 PATI…     6
 5 Mia349 Runte676        Female white Divorced chelms…  71238    44 PATI…     6
 6 Damian46 Dach178       Male   white &lt;NA&gt;     swansea  74155    26 PATI…     6
 7 Nelida367 Emard19      Female white Single   brookl… 501039    30 PATI…     4
 8 Anthony633 Kutch271    Male   asian &lt;NA&gt;     framin… 671128    26 PATI…     6
 9 Mose244 Cummerata161   Male   black Single   saugus  125860    46 PATI…     6
10 Shila857 Heller342     Female white &lt;NA&gt;     marion  134195    22 PATI…     2
# ℹ 76 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> <span class="fu">merge</span>(pat_df_coords, pat_attr[, <span class="fu">c</span>(<span class="st">"NAME"</span>, <span class="st">"block"</span>)], <span class="at">by =</span> <span class="st">"NAME"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>both_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(merged_df, df_coords)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(both_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     NAME GENDER  RACE       CITY      LAT       LON    type
1        Adam631 Hoppe518   Male white  cambridge 42.41904 -71.07128 PATIENT
2     Alesha810 Heaney114 Female white framingham 42.23666 -71.46729 PATIENT
3 Alissa315 Altenwerth646 Female white  wakefield 42.45483 -71.09130 PATIENT
4    Analisa263 Kohler843 Female white     boston 42.38900 -71.04350 PATIENT
5    Annice210 Gleason633 Female white  brookline 42.38652 -71.11319 PATIENT
6     Anthony633 Kutch271   Male asian framingham 42.32681 -71.41111 PATIENT
  block
1     6
2     6
3     5
4     6
5     6
6     6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>pro_attr_list_zip <span class="ot">&lt;-</span> <span class="fu">do.call</span>(list,df_coords)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>pat_attr_list_zip <span class="ot">&lt;-</span> <span class="fu">do.call</span>(list,pat_df_coords)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>attribute_list_zip <span class="ot">&lt;-</span> <span class="fu">do.call</span>(list, both_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>encounters.geo.stat <span class="ot">&lt;-</span> <span class="fu">network</span>(encounters_el,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">directed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bipartite =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">matrix.type =</span> <span class="st">"edgelist"</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">vertex.attr =</span> attribute_list_zip)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'igraph' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'igraph'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tigris':

    blocks</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:sna':

    betweenness, bonpow, closeness, components, degree, dyad.census,
    evcent, hierarchy, is.connected, neighborhood, triad.census</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:network':

    %c%, %s%, add.edges, add.vertices, delete.edges, delete.vertices,
    get.edge.attribute, get.edges, get.vertex.attribute, is.bipartite,
    is.directed, list.edge.attributes, list.vertex.attributes,
    set.edge.attribute, set.vertex.attribute</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:lubridate':

    %--%, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    as_data_frame, groups, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:purrr':

    compose, simplify</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    crossing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tibble':

    as_data_frame</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    decompose, spectrum</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:base':

    union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co">#create igraph</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>encounters.geo.ig <span class="ot">&lt;-</span> <span class="fu">graph_from_biadjacency_matrix</span>(encounters.geo.stat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>encounters.geo.stat2 <span class="ot">&lt;-</span> <span class="fu">asNetwork</span>(encounters.geo.ig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">"package:igraph"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> <span class="fu">get.vertex.attribute</span>(encounters.geo.stat, <span class="st">"GENDER"</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(gender <span class="sc">==</span> <span class="st">"Female"</span>, <span class="st">"pink"</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(gender <span class="sc">==</span> <span class="st">"Male"</span>, <span class="st">"turquoise"</span>, <span class="st">"black"</span>))</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting the coordinates from the network object</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">get.vertex.attribute</span>(encounters.geo.stat, <span class="st">"LAT"</span> )  <span class="co"># Assuming latitude is stored in an attribute named "lat"</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>coords_lon <span class="ot">&lt;-</span> <span class="fu">get.vertex.attribute</span>(encounters.geo.stat, <span class="st">"LON"</span>)  <span class="co"># Assuming longitude is stored in an attribute named "lon"</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a Leaflet map</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(<span class="st">"CartoDB.Positron"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding markers for each coordinate</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng =</span> coords_lon, <span class="at">lat =</span> coords, <span class="at">color =</span> colors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-ddf093268cf7b008254c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ddf093268cf7b008254c">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[42.4190418062449,42.2366578424555,42.4548277198744,42.3889958724171,42.3865226764523,42.3268112065701,42.4578222382458,41.5460899181752,41.9304215336085,41.6382696627178,42.3118517183343,42.4892374592649,42.0602625372101,41.7798362286732,41.695691616957,42.3119094944357,42.6979436733329,41.8830635228547,41.8089991995026,42.3225873785509,42.035365443853,42.6139160753762,42.3194628892464,41.8722269222767,42.5639929748867,42.3527174271696,42.5362794128619,41.7022720332252,42.5932222364215,42.2271671523419,41.6974206759473,42.4536839064362,42.5387576974167,42.6071895264639,42.3542074586058,42.1652707117512,42.6022099493788,42.3337306750991,42.1287565086393,41.6805052394787,42.1334408185512,42.1272816460285,42.4955822915627,42.4564230947938,42.033037855024,42.0114136270562,42.3053021577932,42.1068287535205,42.350405952206,42.4625760341414,42.5914916387687,42.5696369104705,42.5803162879157,42.1494915516857,42.5006125523725,42.2387664516179,42.3677235913164,42.1538708756482,42.2031801551553,42.3277100602921,42.5751688653603,41.7301370607729,41.684265889812,41.6926912900857,42.4975867786776,42.32491678169,41.6683986337562,41.7545719962288,42.3126589346506,42.6443151585345,42.1364816436225,41.8965412191225,41.8161666670466,42.5415482283387,41.7384235499419,42.1399122525571,42.3876073508973,41.6658946818456,42.3094447877859,41.7901531023333,42.3270582854719,42.5420668503447,42.1591991628296,42.2768678555442,41.6506905691286,42.8173191838409,42.2972045,41.6498983,41.7074065,42.4632069,41.6501114,42.58163075,42.3214927,42.2964859,42.1278249,42.34864995,42.57735215,42.25512735,42.1389039,42.0667952,41.64280275,41.884685,42.61322825,42.1178811,41.6753274,42.5792583,42.61322825,42.2625621,42.3026972,41.8455651,42.3430087,42.2964859,42.3213892,42.3501483,42.20017865,42.3150543,42.5253035,42.345093,42.57471215,42.3694992,42.2139873,42.29955605,42.33032115,41.6932713,42.55246265,42.375828,41.7579043,41.94893085,41.9404181,41.91158935,42.0952995,42.36305545,42.3400261429945,42.084901,42.3756401,42.59825485,42.4703546,41.6667779,41.70365955,42.239638,41.8984957,42.47049745,41.8753235,42.1178811,41.7294555,42.4550741,42.54644385,42.5879173,42.28348,42.3778749,41.65171785,42.4863168,42.54031915,42.3955992,41.7676615304297,41.6389926,42.29768,41.971697,42.4792618,42.53587715,41.8459353,42.518096193995,42.1384306,42.1424349,42.2935591883064,42.29337605,41.9266899,42.2843753,42.2501425,42.1886973,42.13496385,42.35853505,41.745636,42.5524742,42.25986305,42.3138278,42.0872752,41.61112,41.742172,41.7020544,42.336831,41.72075205,42.3917638,42.2976266,42.1755398,41.7093779,42.08345955,42.47632115,41.869676,41.9438129,42.5278731,42.04185195,42.75468625,42.1894693,41.6332267,42.18620965,42.6198215,42.54031915,41.730919,41.6562005,42.6809271,41.74223,42.1322823,42.8173801,42.466763,42.3756401,42.37520955,42.23691085,42.23754835,42.16578055,42.2288875,42.1893694,42.1589443,42.470093,42.20234485,42.2879347,42.4600752,42.4977745,41.6761113811674,42.33317295,42.4641001818182,42.1594587,42.2875144,42.16975305,42.2838619,42.3030701,42.5730593,42.32601195,42.256476,42.27728075,42.1487691,42.466763,42.3075806036254,42.3756401,42.5112107,41.646106,42.3334312,42.3104327,42.5792583,42.2731232,42.3768779,42.5952687,42.4600752,42.5903661,42.4524431,41.6839381652532,42.3908493955217,42.518096193995,42.541995,41.74026055,42.231371,42.1886973,42.15547415,42.5903661,42.3138278,41.6484421,42.3746705,42.2907683,42.37050535,42.473347,41.8946107,41.6512968,41.7093779,42.57056335,42.3756401,42.1557747953005,41.65363635,42.58685735,42.0834335,42.2020225,41.9028629,42.1441354,42.375351,42.15029565,41.6318,42.2513683,41.6149879,42.1700209025178,42.57735215,42.58578722272,42.30230485,42.3750976,42.1270746,41.7613849,42.1886973,41.9369576,41.764922,41.68098,42.368937,42.50403445,42.19322885,41.9062805,42.1006094723902,42.81369325,42.5700993,42.3615107,42.586487,42.5141736,41.9419187,42.81369325,42.4979478,41.89112605,42.4699241,42.4814675,42.4504488,42.4792618,42.4564323,42.1325911],[-71.0712777287484,-71.4672943498084,-71.0912964374704,-71.043496075191,-71.1131866429351,-71.41111348804409,-71.1341820955453,-70.913520088401,-71.2809316126618,-71.1012861594243,-71.20692316976771,-70.9598700198386,-71.2881231764536,-71.22337237949451,-70.4688306726091,-71.251396849382,-73.0896359757561,-71.0497268616469,-70.88849172791809,-72.6450685537264,-72.00886088412609,-72.7230597826313,-71.8005353502512,-70.8446184761534,-71.8461804955745,-71.11063421317451,-71.98622854253711,-70.8712380044808,-70.86968070768221,-72.1148749126892,-70.19107350129281,-71.0845476812588,-71.0475561448047,-70.808860749983,-71.1488003738101,-71.4849353617431,-71.88096215089421,-71.0086158061752,-71.31756843882,-70.1861647979856,-70.963160873947,-70.94201898253191,-70.9942033181203,-71.0053055658411,-71.2761291355994,-71.1977918867921,-71.16267122039891,-70.97209802290379,-72.5942222823135,-71.14046810016259,-70.9197409165475,-71.5613505312877,-71.38215071371241,-72.635558815593,-71.03709145209911,-71.0559711541211,-71.17541114499269,-70.92784447155449,-71.0609411418326,-72.4623617460452,-71.56444488153809,-71.1629101204397,-70.165679740475,-70.43180776990189,-71.7928799535876,-71.3219730606682,-70.264124424787,-70.1873944447414,-71.7552568498019,-70.8903484504005,-71.3539615040814,-71.12989839183641,-71.0070830945868,-71.76033459793,-70.72737895990601,-72.5324169258275,-71.2170176953627,-71.00412899009559,-71.889598813821,-71.23935394312301,-71.2349642690526,-71.0849388448987,-72.7765308226228,-71.3344970295968,-70.2109645982152,-70.8592991182352,-71.2107273138049,-70.3430984487668,-71.1459365946245,-71.0093761,-70.2411312,-72.6179501351554,-71.1711481,-71.2925571,-70.8266494748538,-71.14799584850211,-71.5741458734304,-71.8258092480352,-71.97826809999999,-72.0084995,-70.9286500430959,-70.847219,-70.8730067504893,-72.75935246865799,-70.309939,-71.4378411,-70.8730067504893,-71.80188769999999,-71.3537011055077,-70.9519592420845,-71.11701549999999,-71.2925571,-71.2586343,-71.1439332445769,-71.0582074,-72.6255556134909,-71.7584413,-71.139804,-70.9435955691262,-71.110110300101,-71.2244987,-71.7983813381924,-72.6533080260818,-71.1402431739568,-71.6238366574518,-71.2527956,-70.4968152,-71.1414131847519,-71.2728216702394,-71.10129620180319,-72.5094313614233,-71.06643399281769,-71.24911543639161,-71.30689224201799,-71.2358004,-71.8084191453365,-70.964796190519,-70.18474139999999,-71.152591512998,-71.8443785891577,-71.03751432894779,-70.9600366815157,-70.9203570558323,-72.75935246865799,-71.1619017170772,-71.0654799,-70.9928812911228,-72.6055828841603,-71.41845000000001,-71.0619957,-70.21464095380929,-71.0928919,-71.76312990486301,-71.1227391,-70.7309621292582,-70.9703171,-71.13046300000001,-71.1768933402183,-71.15227659999999,-71.7753711504708,-70.9494854,-71.0959083715027,-71.1022598,-71.489431733572,-71.3515805092496,-71.1980635302877,-71.2611303145582,-71.3441395,-71.065573,-71.2005241,-70.9223782449469,-71.2412552121489,-70.658192,-70.9444316554803,-71.8359778602328,-71.77070019999999,-70.9910738855076,-70.93937914285711,-70.45251,-70.249465,-71.04795799999999,-71.16843052114559,-71.0328284,-71.4260534836144,-70.9539153674405,-71.1460783680883,-71.38413379825739,-71.0692216900576,-70.873384,-71.2806515,-70.9286609,-71.23486657070561,-70.9451078257969,-71.85604764999999,-70.9879928,-71.307454952733,-71.3618921297148,-71.76312990486301,-71.208117,-70.2733618824426,-73.09950699822529,-71.129706,-72.74366790000001,-70.8812557365947,-70.94949389999999,-71.2358004,-71.10711344152971,-71.0023719995459,-72.1379154721525,-72.6338963469196,-71.51964390000001,-70.9845198481427,-70.9497043167232,-70.95994,-71.4249327507937,-71.15108161583279,-73.2492795834909,-71.12377119999999,-70.9878852817608,-72.6566355591273,-70.9465129090909,-71.06112167252699,-71.0470691675753,-72.6348803124211,-71.4093719,-71.8333408960994,-71.99713285,-71.22542515807061,-72.237482,-71.2366536281404,-72.60711190000001,-70.94949389999999,-71.4284621572461,-71.2358004,-70.9051624182619,-70.9086520807919,-71.0494949,-71.1888328341186,-71.4378411,-71.3105334275248,-72.5184028078374,-72.59288632376349,-73.2492795834909,-71.8119837,-71.08939988105109,-71.1220830626733,-71.1556550001627,-71.0959083715027,-71.7628835,-70.9450945705336,-72.165386,-71.2005241,-72.47222226666079,-71.8119837,-71.77070019999999,-70.4811383,-71.22789736306839,-71.76497519999999,-71.21908334877379,-71.144086,-71.11113,-70.9669902070805,-71.1460783680883,-71.4173664642241,-71.2358004,-72.5567226328951,-70.2735221923483,-71.98748072431211,-71.0183787,-71.8989161675468,-71.0971892712258,-70.8440854,-71.14686279999999,-72.47288272264809,-70.8801,-71.0768393856917,-70.9311385196367,-71.5940930809949,-71.5741458734304,-71.0086144242722,-71.7661469251106,-70.982827,-71.51639128815469,-70.7191143173718,-71.2005241,-71.2799609175534,-70.50221500000001,-70.18292625685081,-72.5324710720398,-71.0746295151461,-70.9458998765494,-71.0951812135179,-70.94967338146699,-70.8909164574759,-70.8710822425041,-72.55261320852939,-71.80521,-70.97106354209529,-71.27520816952971,-70.8909164574759,-71.1684508,-71.1125410206286,-70.91715069999999,-71.0924311,-71.0907694493843,-71.15227659999999,-71.064182,-71.26188860000001],10,null,null,{"interactive":true,"className":"","stroke":true,"color":["turquoise","pink","pink","pink","pink","turquoise","turquoise","turquoise","pink","pink","pink","pink","turquoise","turquoise","pink","pink","turquoise","pink","pink","pink","pink","pink","turquoise","turquoise","turquoise","pink","pink","turquoise","pink","pink","turquoise","turquoise","turquoise","pink","pink","pink","pink","pink","pink","pink","turquoise","turquoise","turquoise","turquoise","pink","pink","turquoise","pink","turquoise","turquoise","turquoise","pink","pink","turquoise","turquoise","pink","pink","pink","pink","pink","pink","turquoise","pink","turquoise","turquoise","pink","turquoise","turquoise","turquoise","pink","pink","pink","pink","pink","pink","turquoise","turquoise","turquoise","pink","turquoise","pink","turquoise","pink","turquoise","turquoise","turquoise","turquoise","turquoise","pink","turquoise","pink","pink","turquoise","turquoise","turquoise","pink","pink","pink","pink","turquoise","pink","turquoise","turquoise","pink","turquoise","turquoise","turquoise","turquoise","pink","pink","pink","turquoise","pink","pink","pink","turquoise","pink","pink","turquoise","turquoise","turquoise","turquoise","turquoise","pink","turquoise","turquoise","pink","turquoise","pink","turquoise","pink","turquoise","turquoise","pink","turquoise","turquoise","turquoise","pink","turquoise","turquoise","pink","pink","turquoise","turquoise","pink","turquoise","turquoise","pink","pink","turquoise","pink","turquoise","turquoise","pink","turquoise","turquoise","pink","pink","turquoise","pink","pink","turquoise","pink","pink","turquoise","turquoise","turquoise","turquoise","turquoise","turquoise","turquoise","turquoise","turquoise","pink","pink","pink","turquoise","pink","turquoise","pink","turquoise","pink","pink","pink","pink","turquoise","pink","turquoise","pink","turquoise","pink","pink","turquoise","turquoise","turquoise","pink","pink","turquoise","turquoise","turquoise","turquoise","turquoise","pink","turquoise","pink","pink","turquoise","pink","turquoise","pink","turquoise","turquoise","turquoise","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","turquoise","pink","pink","turquoise","pink","pink","turquoise","pink","pink","pink","pink","pink","turquoise","pink","pink","turquoise","pink","pink","turquoise","turquoise","pink","turquoise","turquoise","turquoise","pink","pink","turquoise","pink","turquoise","turquoise","pink","turquoise","pink","pink","turquoise","pink","pink","turquoise","pink","pink","turquoise","pink","turquoise","pink","turquoise","pink","turquoise","turquoise","pink","turquoise","turquoise","turquoise","pink","pink","turquoise","turquoise","pink","pink","pink","pink","pink","pink","turquoise","pink","turquoise","turquoise","pink","turquoise","pink","pink","pink","turquoise","turquoise","turquoise","pink","turquoise","turquoise","turquoise","turquoise","pink","turquoise","turquoise","turquoise"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["turquoise","pink","pink","pink","pink","turquoise","turquoise","turquoise","pink","pink","pink","pink","turquoise","turquoise","pink","pink","turquoise","pink","pink","pink","pink","pink","turquoise","turquoise","turquoise","pink","pink","turquoise","pink","pink","turquoise","turquoise","turquoise","pink","pink","pink","pink","pink","pink","pink","turquoise","turquoise","turquoise","turquoise","pink","pink","turquoise","pink","turquoise","turquoise","turquoise","pink","pink","turquoise","turquoise","pink","pink","pink","pink","pink","pink","turquoise","pink","turquoise","turquoise","pink","turquoise","turquoise","turquoise","pink","pink","pink","pink","pink","pink","turquoise","turquoise","turquoise","pink","turquoise","pink","turquoise","pink","turquoise","turquoise","turquoise","turquoise","turquoise","pink","turquoise","pink","pink","turquoise","turquoise","turquoise","pink","pink","pink","pink","turquoise","pink","turquoise","turquoise","pink","turquoise","turquoise","turquoise","turquoise","pink","pink","pink","turquoise","pink","pink","pink","turquoise","pink","pink","turquoise","turquoise","turquoise","turquoise","turquoise","pink","turquoise","turquoise","pink","turquoise","pink","turquoise","pink","turquoise","turquoise","pink","turquoise","turquoise","turquoise","pink","turquoise","turquoise","pink","pink","turquoise","turquoise","pink","turquoise","turquoise","pink","pink","turquoise","pink","turquoise","turquoise","pink","turquoise","turquoise","pink","pink","turquoise","pink","pink","turquoise","pink","pink","turquoise","turquoise","turquoise","turquoise","turquoise","turquoise","turquoise","turquoise","turquoise","pink","pink","pink","turquoise","pink","turquoise","pink","turquoise","pink","pink","pink","pink","turquoise","pink","turquoise","pink","turquoise","pink","pink","turquoise","turquoise","turquoise","pink","pink","turquoise","turquoise","turquoise","turquoise","turquoise","pink","turquoise","pink","pink","turquoise","pink","turquoise","pink","turquoise","turquoise","turquoise","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","pink","turquoise","pink","pink","turquoise","pink","pink","turquoise","pink","pink","pink","pink","pink","turquoise","pink","pink","turquoise","pink","pink","turquoise","turquoise","pink","turquoise","turquoise","turquoise","pink","pink","turquoise","pink","turquoise","turquoise","pink","turquoise","pink","pink","turquoise","pink","pink","turquoise","pink","pink","turquoise","pink","turquoise","pink","turquoise","pink","turquoise","turquoise","pink","turquoise","turquoise","turquoise","pink","pink","turquoise","turquoise","pink","pink","pink","pink","pink","pink","turquoise","pink","turquoise","turquoise","pink","turquoise","pink","pink","pink","turquoise","turquoise","turquoise","pink","turquoise","turquoise","turquoise","turquoise","pink","turquoise","turquoise","turquoise"],"fillOpacity":0.2},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[41.5460899181752,42.8173801],"lng":[-73.2492795834909,-70.165679740475]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>block <span class="ot">&lt;-</span> <span class="fu">get.vertex.attribute</span>(encounters.geo.stat, <span class="st">"block"</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming encounters.geo.stat is your network object containing the block attribute</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming block is the name of the attribute containing block information</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming coords_lon and coords are your longitude and latitude coordinates</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors based on block values</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span>  <span class="fu">ifelse</span>(block <span class="sc">==</span> <span class="st">"1"</span>, <span class="st">"red"</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(block <span class="sc">==</span> <span class="st">"2"</span>, <span class="st">"orange"</span>,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">ifelse</span>(block <span class="sc">==</span> <span class="st">"3"</span>, <span class="st">"yellow"</span>,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(block <span class="sc">==</span> <span class="st">"4"</span>, <span class="st">"green"</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(block <span class="sc">==</span> <span class="st">"5"</span>, <span class="st">"blue"</span>, </span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(block <span class="sc">==</span> <span class="st">"6"</span>, <span class="st">"purple"</span>, </span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"black"</span>)))))) <span class="co"># Add more colors as needed</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a Leaflet map</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addProviderTiles</span>(<span class="st">"CartoDB.Positron"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding markers for each coordinate with color based on block attribute</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng =</span> coords_lon, <span class="at">lat =</span> coords,</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> colors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-5a7687b44676bbc6a773" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5a7687b44676bbc6a773">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[42.4190418062449,42.2366578424555,42.4548277198744,42.3889958724171,42.3865226764523,42.3268112065701,42.4578222382458,41.5460899181752,41.9304215336085,41.6382696627178,42.3118517183343,42.4892374592649,42.0602625372101,41.7798362286732,41.695691616957,42.3119094944357,42.6979436733329,41.8830635228547,41.8089991995026,42.3225873785509,42.035365443853,42.6139160753762,42.3194628892464,41.8722269222767,42.5639929748867,42.3527174271696,42.5362794128619,41.7022720332252,42.5932222364215,42.2271671523419,41.6974206759473,42.4536839064362,42.5387576974167,42.6071895264639,42.3542074586058,42.1652707117512,42.6022099493788,42.3337306750991,42.1287565086393,41.6805052394787,42.1334408185512,42.1272816460285,42.4955822915627,42.4564230947938,42.033037855024,42.0114136270562,42.3053021577932,42.1068287535205,42.350405952206,42.4625760341414,42.5914916387687,42.5696369104705,42.5803162879157,42.1494915516857,42.5006125523725,42.2387664516179,42.3677235913164,42.1538708756482,42.2031801551553,42.3277100602921,42.5751688653603,41.7301370607729,41.684265889812,41.6926912900857,42.4975867786776,42.32491678169,41.6683986337562,41.7545719962288,42.3126589346506,42.6443151585345,42.1364816436225,41.8965412191225,41.8161666670466,42.5415482283387,41.7384235499419,42.1399122525571,42.3876073508973,41.6658946818456,42.3094447877859,41.7901531023333,42.3270582854719,42.5420668503447,42.1591991628296,42.2768678555442,41.6506905691286,42.8173191838409,42.2972045,41.6498983,41.7074065,42.4632069,41.6501114,42.58163075,42.3214927,42.2964859,42.1278249,42.34864995,42.57735215,42.25512735,42.1389039,42.0667952,41.64280275,41.884685,42.61322825,42.1178811,41.6753274,42.5792583,42.61322825,42.2625621,42.3026972,41.8455651,42.3430087,42.2964859,42.3213892,42.3501483,42.20017865,42.3150543,42.5253035,42.345093,42.57471215,42.3694992,42.2139873,42.29955605,42.33032115,41.6932713,42.55246265,42.375828,41.7579043,41.94893085,41.9404181,41.91158935,42.0952995,42.36305545,42.3400261429945,42.084901,42.3756401,42.59825485,42.4703546,41.6667779,41.70365955,42.239638,41.8984957,42.47049745,41.8753235,42.1178811,41.7294555,42.4550741,42.54644385,42.5879173,42.28348,42.3778749,41.65171785,42.4863168,42.54031915,42.3955992,41.7676615304297,41.6389926,42.29768,41.971697,42.4792618,42.53587715,41.8459353,42.518096193995,42.1384306,42.1424349,42.2935591883064,42.29337605,41.9266899,42.2843753,42.2501425,42.1886973,42.13496385,42.35853505,41.745636,42.5524742,42.25986305,42.3138278,42.0872752,41.61112,41.742172,41.7020544,42.336831,41.72075205,42.3917638,42.2976266,42.1755398,41.7093779,42.08345955,42.47632115,41.869676,41.9438129,42.5278731,42.04185195,42.75468625,42.1894693,41.6332267,42.18620965,42.6198215,42.54031915,41.730919,41.6562005,42.6809271,41.74223,42.1322823,42.8173801,42.466763,42.3756401,42.37520955,42.23691085,42.23754835,42.16578055,42.2288875,42.1893694,42.1589443,42.470093,42.20234485,42.2879347,42.4600752,42.4977745,41.6761113811674,42.33317295,42.4641001818182,42.1594587,42.2875144,42.16975305,42.2838619,42.3030701,42.5730593,42.32601195,42.256476,42.27728075,42.1487691,42.466763,42.3075806036254,42.3756401,42.5112107,41.646106,42.3334312,42.3104327,42.5792583,42.2731232,42.3768779,42.5952687,42.4600752,42.5903661,42.4524431,41.6839381652532,42.3908493955217,42.518096193995,42.541995,41.74026055,42.231371,42.1886973,42.15547415,42.5903661,42.3138278,41.6484421,42.3746705,42.2907683,42.37050535,42.473347,41.8946107,41.6512968,41.7093779,42.57056335,42.3756401,42.1557747953005,41.65363635,42.58685735,42.0834335,42.2020225,41.9028629,42.1441354,42.375351,42.15029565,41.6318,42.2513683,41.6149879,42.1700209025178,42.57735215,42.58578722272,42.30230485,42.3750976,42.1270746,41.7613849,42.1886973,41.9369576,41.764922,41.68098,42.368937,42.50403445,42.19322885,41.9062805,42.1006094723902,42.81369325,42.5700993,42.3615107,42.586487,42.5141736,41.9419187,42.81369325,42.4979478,41.89112605,42.4699241,42.4814675,42.4504488,42.4792618,42.4564323,42.1325911],[-71.0712777287484,-71.4672943498084,-71.0912964374704,-71.043496075191,-71.1131866429351,-71.41111348804409,-71.1341820955453,-70.913520088401,-71.2809316126618,-71.1012861594243,-71.20692316976771,-70.9598700198386,-71.2881231764536,-71.22337237949451,-70.4688306726091,-71.251396849382,-73.0896359757561,-71.0497268616469,-70.88849172791809,-72.6450685537264,-72.00886088412609,-72.7230597826313,-71.8005353502512,-70.8446184761534,-71.8461804955745,-71.11063421317451,-71.98622854253711,-70.8712380044808,-70.86968070768221,-72.1148749126892,-70.19107350129281,-71.0845476812588,-71.0475561448047,-70.808860749983,-71.1488003738101,-71.4849353617431,-71.88096215089421,-71.0086158061752,-71.31756843882,-70.1861647979856,-70.963160873947,-70.94201898253191,-70.9942033181203,-71.0053055658411,-71.2761291355994,-71.1977918867921,-71.16267122039891,-70.97209802290379,-72.5942222823135,-71.14046810016259,-70.9197409165475,-71.5613505312877,-71.38215071371241,-72.635558815593,-71.03709145209911,-71.0559711541211,-71.17541114499269,-70.92784447155449,-71.0609411418326,-72.4623617460452,-71.56444488153809,-71.1629101204397,-70.165679740475,-70.43180776990189,-71.7928799535876,-71.3219730606682,-70.264124424787,-70.1873944447414,-71.7552568498019,-70.8903484504005,-71.3539615040814,-71.12989839183641,-71.0070830945868,-71.76033459793,-70.72737895990601,-72.5324169258275,-71.2170176953627,-71.00412899009559,-71.889598813821,-71.23935394312301,-71.2349642690526,-71.0849388448987,-72.7765308226228,-71.3344970295968,-70.2109645982152,-70.8592991182352,-71.2107273138049,-70.3430984487668,-71.1459365946245,-71.0093761,-70.2411312,-72.6179501351554,-71.1711481,-71.2925571,-70.8266494748538,-71.14799584850211,-71.5741458734304,-71.8258092480352,-71.97826809999999,-72.0084995,-70.9286500430959,-70.847219,-70.8730067504893,-72.75935246865799,-70.309939,-71.4378411,-70.8730067504893,-71.80188769999999,-71.3537011055077,-70.9519592420845,-71.11701549999999,-71.2925571,-71.2586343,-71.1439332445769,-71.0582074,-72.6255556134909,-71.7584413,-71.139804,-70.9435955691262,-71.110110300101,-71.2244987,-71.7983813381924,-72.6533080260818,-71.1402431739568,-71.6238366574518,-71.2527956,-70.4968152,-71.1414131847519,-71.2728216702394,-71.10129620180319,-72.5094313614233,-71.06643399281769,-71.24911543639161,-71.30689224201799,-71.2358004,-71.8084191453365,-70.964796190519,-70.18474139999999,-71.152591512998,-71.8443785891577,-71.03751432894779,-70.9600366815157,-70.9203570558323,-72.75935246865799,-71.1619017170772,-71.0654799,-70.9928812911228,-72.6055828841603,-71.41845000000001,-71.0619957,-70.21464095380929,-71.0928919,-71.76312990486301,-71.1227391,-70.7309621292582,-70.9703171,-71.13046300000001,-71.1768933402183,-71.15227659999999,-71.7753711504708,-70.9494854,-71.0959083715027,-71.1022598,-71.489431733572,-71.3515805092496,-71.1980635302877,-71.2611303145582,-71.3441395,-71.065573,-71.2005241,-70.9223782449469,-71.2412552121489,-70.658192,-70.9444316554803,-71.8359778602328,-71.77070019999999,-70.9910738855076,-70.93937914285711,-70.45251,-70.249465,-71.04795799999999,-71.16843052114559,-71.0328284,-71.4260534836144,-70.9539153674405,-71.1460783680883,-71.38413379825739,-71.0692216900576,-70.873384,-71.2806515,-70.9286609,-71.23486657070561,-70.9451078257969,-71.85604764999999,-70.9879928,-71.307454952733,-71.3618921297148,-71.76312990486301,-71.208117,-70.2733618824426,-73.09950699822529,-71.129706,-72.74366790000001,-70.8812557365947,-70.94949389999999,-71.2358004,-71.10711344152971,-71.0023719995459,-72.1379154721525,-72.6338963469196,-71.51964390000001,-70.9845198481427,-70.9497043167232,-70.95994,-71.4249327507937,-71.15108161583279,-73.2492795834909,-71.12377119999999,-70.9878852817608,-72.6566355591273,-70.9465129090909,-71.06112167252699,-71.0470691675753,-72.6348803124211,-71.4093719,-71.8333408960994,-71.99713285,-71.22542515807061,-72.237482,-71.2366536281404,-72.60711190000001,-70.94949389999999,-71.4284621572461,-71.2358004,-70.9051624182619,-70.9086520807919,-71.0494949,-71.1888328341186,-71.4378411,-71.3105334275248,-72.5184028078374,-72.59288632376349,-73.2492795834909,-71.8119837,-71.08939988105109,-71.1220830626733,-71.1556550001627,-71.0959083715027,-71.7628835,-70.9450945705336,-72.165386,-71.2005241,-72.47222226666079,-71.8119837,-71.77070019999999,-70.4811383,-71.22789736306839,-71.76497519999999,-71.21908334877379,-71.144086,-71.11113,-70.9669902070805,-71.1460783680883,-71.4173664642241,-71.2358004,-72.5567226328951,-70.2735221923483,-71.98748072431211,-71.0183787,-71.8989161675468,-71.0971892712258,-70.8440854,-71.14686279999999,-72.47288272264809,-70.8801,-71.0768393856917,-70.9311385196367,-71.5940930809949,-71.5741458734304,-71.0086144242722,-71.7661469251106,-70.982827,-71.51639128815469,-70.7191143173718,-71.2005241,-71.2799609175534,-70.50221500000001,-70.18292625685081,-72.5324710720398,-71.0746295151461,-70.9458998765494,-71.0951812135179,-70.94967338146699,-70.8909164574759,-70.8710822425041,-72.55261320852939,-71.80521,-70.97106354209529,-71.27520816952971,-70.8909164574759,-71.1684508,-71.1125410206286,-70.91715069999999,-71.0924311,-71.0907694493843,-71.15227659999999,-71.064182,-71.26188860000001],10,null,null,{"interactive":true,"className":"","stroke":true,"color":["purple","purple","blue","purple","purple","purple","purple","yellow","yellow","yellow","green","purple","yellow","purple","purple","green","purple","yellow","orange","purple","purple","blue","purple","purple","blue","blue","purple","orange","purple","purple","red","purple","blue","purple","purple","purple","purple","purple","purple","blue","purple","purple","blue","blue","purple","yellow","purple","blue","purple","purple","blue","blue","purple","purple","purple","purple","green","purple","purple","purple","purple","blue","orange","purple","blue","green","red","blue","purple","purple","blue","purple","yellow","purple","orange","purple","green","purple","purple","yellow","green","purple","purple","purple","orange","purple","yellow","yellow","yellow","purple","blue","blue","yellow","yellow","blue","yellow","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","yellow","blue","yellow","yellow","yellow","yellow","yellow","blue","yellow","blue","blue","red","yellow","yellow","yellow","yellow","green","yellow","yellow","yellow","yellow","yellow","yellow","green","yellow","green","blue","purple","blue","blue","yellow","yellow","purple","yellow","yellow","blue","yellow","blue","blue","yellow","yellow","yellow","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","yellow","yellow","red","yellow","yellow","yellow","red","yellow","yellow","yellow","green","yellow","blue","yellow","yellow","blue","yellow","yellow","blue","yellow","blue","yellow","yellow","yellow","blue","red","yellow","yellow","blue","blue","yellow","yellow","yellow","yellow","red","yellow","blue","yellow","blue","yellow","yellow","yellow","yellow","purple","green","blue","yellow","yellow","yellow","yellow","yellow","yellow","purple","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","green","yellow","yellow","yellow","purple","yellow","green","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","blue","blue","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","yellow","green","yellow","green","yellow","yellow","yellow","blue","yellow","green","yellow","blue","yellow","blue","yellow","yellow","blue","yellow","yellow","yellow","yellow","yellow","yellow","blue","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","blue","yellow","yellow","blue","yellow","yellow","yellow","orange","purple","yellow","yellow","yellow","yellow","yellow","blue","blue","yellow","yellow","red"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["purple","purple","blue","purple","purple","purple","purple","yellow","yellow","yellow","green","purple","yellow","purple","purple","green","purple","yellow","orange","purple","purple","blue","purple","purple","blue","blue","purple","orange","purple","purple","red","purple","blue","purple","purple","purple","purple","purple","purple","blue","purple","purple","blue","blue","purple","yellow","purple","blue","purple","purple","blue","blue","purple","purple","purple","purple","green","purple","purple","purple","purple","blue","orange","purple","blue","green","red","blue","purple","purple","blue","purple","yellow","purple","orange","purple","green","purple","purple","yellow","green","purple","purple","purple","orange","purple","yellow","yellow","yellow","purple","blue","blue","yellow","yellow","blue","yellow","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","yellow","blue","yellow","yellow","yellow","yellow","yellow","blue","yellow","blue","blue","red","yellow","yellow","yellow","yellow","green","yellow","yellow","yellow","yellow","yellow","yellow","green","yellow","green","blue","purple","blue","blue","yellow","yellow","purple","yellow","yellow","blue","yellow","blue","blue","yellow","yellow","yellow","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","yellow","yellow","red","yellow","yellow","yellow","red","yellow","yellow","yellow","green","yellow","blue","yellow","yellow","blue","yellow","yellow","blue","yellow","blue","yellow","yellow","yellow","blue","red","yellow","yellow","blue","blue","yellow","yellow","yellow","yellow","red","yellow","blue","yellow","blue","yellow","yellow","yellow","yellow","purple","green","blue","yellow","yellow","yellow","yellow","yellow","yellow","purple","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","green","yellow","yellow","yellow","purple","yellow","green","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","blue","blue","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","yellow","green","yellow","green","yellow","yellow","yellow","blue","yellow","green","yellow","blue","yellow","blue","yellow","yellow","blue","yellow","yellow","yellow","yellow","yellow","yellow","blue","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","blue","yellow","yellow","blue","yellow","yellow","yellow","orange","purple","yellow","yellow","yellow","yellow","yellow","blue","blue","yellow","yellow","red"],"fillOpacity":0.2},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[41.5460899181752,42.8173801],"lng":[-73.2492795834909,-70.165679740475]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>try for providers only?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>provider.geo.stat <span class="ot">&lt;-</span> <span class="fu">network</span>(provider_matrix,</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">directed =</span> <span class="cn">FALSE</span>,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">matrix.type =</span> <span class="st">"adjacency"</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">vertex.attr =</span> pro_attr_list_zip)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting the coordinates from the network object</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>pro_coords <span class="ot">&lt;-</span> <span class="fu">get.vertex.attribute</span>(provider.geo.stat, <span class="st">"LAT"</span>)  <span class="co"># Assuming latitude is stored in an attribute named "lat"</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>pro_coords_lon <span class="ot">&lt;-</span> <span class="fu">get.vertex.attribute</span>(provider.geo.stat, <span class="st">"LON"</span>)  <span class="co"># Assuming longitude is stored in an attribute named "lon"</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a Leaflet map</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding markers for each coordinate</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="at">lng =</span> pro_coords_lon, <span class="at">lat =</span> pro_coords)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-8d30c891e1ebd40fff37" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8d30c891e1ebd40fff37">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addMarkers","args":[[42.2972045,41.6498983,41.7074065,42.4632069,41.6501114,42.58163075,42.3214927,42.2964859,42.1278249,42.34864995,42.57735215,42.25512735,42.1389039,42.0667952,41.64280275,41.884685,42.61322825,42.1178811,41.6753274,42.5792583,42.61322825,42.2625621,42.3026972,41.8455651,42.3430087,42.2964859,42.3213892,42.3501483,42.20017865,42.3150543,42.5253035,42.345093,42.57471215,42.3694992,42.2139873,42.29955605,42.33032115,41.6932713,42.55246265,42.375828,41.7579043,41.94893085,41.9404181,41.91158935,42.0952995,42.36305545,42.3400261429945,42.084901,42.3756401,42.59825485,42.4703546,41.6667779,41.70365955,42.239638,41.8984957,42.47049745,41.8753235,42.1178811,41.7294555,42.4550741,42.54644385,42.5879173,42.28348,42.3778749,41.65171785,42.4863168,42.54031915,42.3955992,41.7676615304297,41.6389926,42.29768,41.971697,42.4792618,42.53587715,41.8459353,42.518096193995,42.1384306,42.1424349,42.2935591883064,42.29337605,41.9266899,42.2843753,42.2501425,42.1886973,42.13496385,42.35853505,41.745636,42.5524742,42.25986305,42.3138278,42.0872752,41.61112,41.742172,41.7020544,42.336831,41.72075205,42.3917638,42.2976266,42.1755398,41.7093779,42.08345955,42.47632115,41.869676,41.9438129,42.5278731,42.04185195,42.75468625,42.1894693,41.6332267,42.18620965,42.6198215,42.54031915,41.730919,41.6562005,42.6809271,41.74223,42.1322823,42.8173801,42.466763,42.3756401,42.37520955,42.23691085,42.23754835,42.16578055,42.2288875,42.1893694,42.1589443,42.470093,42.20234485,42.2879347,42.4600752,42.4977745,41.6761113811674,42.33317295,42.4641001818182,42.1594587,42.2875144,42.16975305,42.2838619,42.3030701,42.5730593,42.32601195,42.256476,42.27728075,42.1487691,42.466763,42.3075806036254,42.3756401,42.5112107,41.646106,42.3334312,42.3104327,42.5792583,42.2731232,42.3768779,42.5952687,42.4600752,42.5903661,42.4524431,41.6839381652532,42.3908493955217,42.518096193995,42.541995,41.74026055,42.231371,42.1886973,42.15547415,42.5903661,42.3138278,41.6484421,42.3746705,42.2907683,42.37050535,42.473347,41.8946107,41.6512968,41.7093779,42.57056335,42.3756401,42.1557747953005,41.65363635,42.58685735,42.0834335,42.2020225,41.9028629,42.1441354,42.375351,42.15029565,41.6318,42.2513683,41.6149879,42.1700209025178,42.57735215,42.58578722272,42.30230485,42.3750976,42.1270746,41.7613849,42.1886973,41.9369576,41.764922,41.68098,42.368937,42.50403445,42.19322885,41.9062805,42.1006094723902,42.81369325,42.5700993,42.3615107,42.586487,42.5141736,41.9419187,42.81369325,42.4979478,41.89112605,42.4699241,42.4814675,42.4504488,42.4792618,42.4564323,42.1325911],[-71.2107273138049,-70.3430984487668,-71.1459365946245,-71.0093761,-70.2411312,-72.6179501351554,-71.1711481,-71.2925571,-70.8266494748538,-71.14799584850211,-71.5741458734304,-71.8258092480352,-71.97826809999999,-72.0084995,-70.9286500430959,-70.847219,-70.8730067504893,-72.75935246865799,-70.309939,-71.4378411,-70.8730067504893,-71.80188769999999,-71.3537011055077,-70.9519592420845,-71.11701549999999,-71.2925571,-71.2586343,-71.1439332445769,-71.0582074,-72.6255556134909,-71.7584413,-71.139804,-70.9435955691262,-71.110110300101,-71.2244987,-71.7983813381924,-72.6533080260818,-71.1402431739568,-71.6238366574518,-71.2527956,-70.4968152,-71.1414131847519,-71.2728216702394,-71.10129620180319,-72.5094313614233,-71.06643399281769,-71.24911543639161,-71.30689224201799,-71.2358004,-71.8084191453365,-70.964796190519,-70.18474139999999,-71.152591512998,-71.8443785891577,-71.03751432894779,-70.9600366815157,-70.9203570558323,-72.75935246865799,-71.1619017170772,-71.0654799,-70.9928812911228,-72.6055828841603,-71.41845000000001,-71.0619957,-70.21464095380929,-71.0928919,-71.76312990486301,-71.1227391,-70.7309621292582,-70.9703171,-71.13046300000001,-71.1768933402183,-71.15227659999999,-71.7753711504708,-70.9494854,-71.0959083715027,-71.1022598,-71.489431733572,-71.3515805092496,-71.1980635302877,-71.2611303145582,-71.3441395,-71.065573,-71.2005241,-70.9223782449469,-71.2412552121489,-70.658192,-70.9444316554803,-71.8359778602328,-71.77070019999999,-70.9910738855076,-70.93937914285711,-70.45251,-70.249465,-71.04795799999999,-71.16843052114559,-71.0328284,-71.4260534836144,-70.9539153674405,-71.1460783680883,-71.38413379825739,-71.0692216900576,-70.873384,-71.2806515,-70.9286609,-71.23486657070561,-70.9451078257969,-71.85604764999999,-70.9879928,-71.307454952733,-71.3618921297148,-71.76312990486301,-71.208117,-70.2733618824426,-73.09950699822529,-71.129706,-72.74366790000001,-70.8812557365947,-70.94949389999999,-71.2358004,-71.10711344152971,-71.0023719995459,-72.1379154721525,-72.6338963469196,-71.51964390000001,-70.9845198481427,-70.9497043167232,-70.95994,-71.4249327507937,-71.15108161583279,-73.2492795834909,-71.12377119999999,-70.9878852817608,-72.6566355591273,-70.9465129090909,-71.06112167252699,-71.0470691675753,-72.6348803124211,-71.4093719,-71.8333408960994,-71.99713285,-71.22542515807061,-72.237482,-71.2366536281404,-72.60711190000001,-70.94949389999999,-71.4284621572461,-71.2358004,-70.9051624182619,-70.9086520807919,-71.0494949,-71.1888328341186,-71.4378411,-71.3105334275248,-72.5184028078374,-72.59288632376349,-73.2492795834909,-71.8119837,-71.08939988105109,-71.1220830626733,-71.1556550001627,-71.0959083715027,-71.7628835,-70.9450945705336,-72.165386,-71.2005241,-72.47222226666079,-71.8119837,-71.77070019999999,-70.4811383,-71.22789736306839,-71.76497519999999,-71.21908334877379,-71.144086,-71.11113,-70.9669902070805,-71.1460783680883,-71.4173664642241,-71.2358004,-72.5567226328951,-70.2735221923483,-71.98748072431211,-71.0183787,-71.8989161675468,-71.0971892712258,-70.8440854,-71.14686279999999,-72.47288272264809,-70.8801,-71.0768393856917,-70.9311385196367,-71.5940930809949,-71.5741458734304,-71.0086144242722,-71.7661469251106,-70.982827,-71.51639128815469,-70.7191143173718,-71.2005241,-71.2799609175534,-70.50221500000001,-70.18292625685081,-72.5324710720398,-71.0746295151461,-70.9458998765494,-71.0951812135179,-70.94967338146699,-70.8909164574759,-70.8710822425041,-72.55261320852939,-71.80521,-70.97106354209529,-71.27520816952971,-70.8909164574759,-71.1684508,-71.1125410206286,-70.91715069999999,-71.0924311,-71.0907694493843,-71.15227659999999,-71.064182,-71.26188860000001],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[41.61112,42.8173801],"lng":[-73.2492795834909,-70.18292625685081]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>pro_block <span class="ot">&lt;-</span> <span class="fu">get.vertex.attribute</span>(provider.geo.stat, <span class="st">"block"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming encounters.geo.stat is your network object containing the block attribute</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming block is the name of the attribute containing block information</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming coords_lon and coords are your longitude and latitude coordinates</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors based on block values</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>pro_colors <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(block <span class="sc">==</span> <span class="st">"1"</span>, <span class="st">"red"</span>,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(block <span class="sc">==</span> <span class="st">"2"</span>, <span class="st">"orange"</span>,</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">ifelse</span>(block <span class="sc">==</span> <span class="st">"3"</span>, <span class="st">"yellow"</span>,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(block <span class="sc">==</span> <span class="st">"4"</span>, <span class="st">"green"</span>,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(block <span class="sc">==</span> <span class="st">"5"</span>, <span class="st">"blue"</span>, </span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(block <span class="sc">==</span> <span class="st">"6"</span>, <span class="st">"purple"</span>, </span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"black"</span>))))))  <span class="co"># Add more colors as needed</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a Leaflet map</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding markers for each coordinate with color based on block attribute</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addCircleMarkers</span>(<span class="at">lng =</span> pro_coords_lon, <span class="at">lat =</span> pro_coords,</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> pro_colors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-4a2fdebc39b6e9757b9c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-4a2fdebc39b6e9757b9c">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addCircleMarkers","args":[[42.2972045,41.6498983,41.7074065,42.4632069,41.6501114,42.58163075,42.3214927,42.2964859,42.1278249,42.34864995,42.57735215,42.25512735,42.1389039,42.0667952,41.64280275,41.884685,42.61322825,42.1178811,41.6753274,42.5792583,42.61322825,42.2625621,42.3026972,41.8455651,42.3430087,42.2964859,42.3213892,42.3501483,42.20017865,42.3150543,42.5253035,42.345093,42.57471215,42.3694992,42.2139873,42.29955605,42.33032115,41.6932713,42.55246265,42.375828,41.7579043,41.94893085,41.9404181,41.91158935,42.0952995,42.36305545,42.3400261429945,42.084901,42.3756401,42.59825485,42.4703546,41.6667779,41.70365955,42.239638,41.8984957,42.47049745,41.8753235,42.1178811,41.7294555,42.4550741,42.54644385,42.5879173,42.28348,42.3778749,41.65171785,42.4863168,42.54031915,42.3955992,41.7676615304297,41.6389926,42.29768,41.971697,42.4792618,42.53587715,41.8459353,42.518096193995,42.1384306,42.1424349,42.2935591883064,42.29337605,41.9266899,42.2843753,42.2501425,42.1886973,42.13496385,42.35853505,41.745636,42.5524742,42.25986305,42.3138278,42.0872752,41.61112,41.742172,41.7020544,42.336831,41.72075205,42.3917638,42.2976266,42.1755398,41.7093779,42.08345955,42.47632115,41.869676,41.9438129,42.5278731,42.04185195,42.75468625,42.1894693,41.6332267,42.18620965,42.6198215,42.54031915,41.730919,41.6562005,42.6809271,41.74223,42.1322823,42.8173801,42.466763,42.3756401,42.37520955,42.23691085,42.23754835,42.16578055,42.2288875,42.1893694,42.1589443,42.470093,42.20234485,42.2879347,42.4600752,42.4977745,41.6761113811674,42.33317295,42.4641001818182,42.1594587,42.2875144,42.16975305,42.2838619,42.3030701,42.5730593,42.32601195,42.256476,42.27728075,42.1487691,42.466763,42.3075806036254,42.3756401,42.5112107,41.646106,42.3334312,42.3104327,42.5792583,42.2731232,42.3768779,42.5952687,42.4600752,42.5903661,42.4524431,41.6839381652532,42.3908493955217,42.518096193995,42.541995,41.74026055,42.231371,42.1886973,42.15547415,42.5903661,42.3138278,41.6484421,42.3746705,42.2907683,42.37050535,42.473347,41.8946107,41.6512968,41.7093779,42.57056335,42.3756401,42.1557747953005,41.65363635,42.58685735,42.0834335,42.2020225,41.9028629,42.1441354,42.375351,42.15029565,41.6318,42.2513683,41.6149879,42.1700209025178,42.57735215,42.58578722272,42.30230485,42.3750976,42.1270746,41.7613849,42.1886973,41.9369576,41.764922,41.68098,42.368937,42.50403445,42.19322885,41.9062805,42.1006094723902,42.81369325,42.5700993,42.3615107,42.586487,42.5141736,41.9419187,42.81369325,42.4979478,41.89112605,42.4699241,42.4814675,42.4504488,42.4792618,42.4564323,42.1325911],[-71.2107273138049,-70.3430984487668,-71.1459365946245,-71.0093761,-70.2411312,-72.6179501351554,-71.1711481,-71.2925571,-70.8266494748538,-71.14799584850211,-71.5741458734304,-71.8258092480352,-71.97826809999999,-72.0084995,-70.9286500430959,-70.847219,-70.8730067504893,-72.75935246865799,-70.309939,-71.4378411,-70.8730067504893,-71.80188769999999,-71.3537011055077,-70.9519592420845,-71.11701549999999,-71.2925571,-71.2586343,-71.1439332445769,-71.0582074,-72.6255556134909,-71.7584413,-71.139804,-70.9435955691262,-71.110110300101,-71.2244987,-71.7983813381924,-72.6533080260818,-71.1402431739568,-71.6238366574518,-71.2527956,-70.4968152,-71.1414131847519,-71.2728216702394,-71.10129620180319,-72.5094313614233,-71.06643399281769,-71.24911543639161,-71.30689224201799,-71.2358004,-71.8084191453365,-70.964796190519,-70.18474139999999,-71.152591512998,-71.8443785891577,-71.03751432894779,-70.9600366815157,-70.9203570558323,-72.75935246865799,-71.1619017170772,-71.0654799,-70.9928812911228,-72.6055828841603,-71.41845000000001,-71.0619957,-70.21464095380929,-71.0928919,-71.76312990486301,-71.1227391,-70.7309621292582,-70.9703171,-71.13046300000001,-71.1768933402183,-71.15227659999999,-71.7753711504708,-70.9494854,-71.0959083715027,-71.1022598,-71.489431733572,-71.3515805092496,-71.1980635302877,-71.2611303145582,-71.3441395,-71.065573,-71.2005241,-70.9223782449469,-71.2412552121489,-70.658192,-70.9444316554803,-71.8359778602328,-71.77070019999999,-70.9910738855076,-70.93937914285711,-70.45251,-70.249465,-71.04795799999999,-71.16843052114559,-71.0328284,-71.4260534836144,-70.9539153674405,-71.1460783680883,-71.38413379825739,-71.0692216900576,-70.873384,-71.2806515,-70.9286609,-71.23486657070561,-70.9451078257969,-71.85604764999999,-70.9879928,-71.307454952733,-71.3618921297148,-71.76312990486301,-71.208117,-70.2733618824426,-73.09950699822529,-71.129706,-72.74366790000001,-70.8812557365947,-70.94949389999999,-71.2358004,-71.10711344152971,-71.0023719995459,-72.1379154721525,-72.6338963469196,-71.51964390000001,-70.9845198481427,-70.9497043167232,-70.95994,-71.4249327507937,-71.15108161583279,-73.2492795834909,-71.12377119999999,-70.9878852817608,-72.6566355591273,-70.9465129090909,-71.06112167252699,-71.0470691675753,-72.6348803124211,-71.4093719,-71.8333408960994,-71.99713285,-71.22542515807061,-72.237482,-71.2366536281404,-72.60711190000001,-70.94949389999999,-71.4284621572461,-71.2358004,-70.9051624182619,-70.9086520807919,-71.0494949,-71.1888328341186,-71.4378411,-71.3105334275248,-72.5184028078374,-72.59288632376349,-73.2492795834909,-71.8119837,-71.08939988105109,-71.1220830626733,-71.1556550001627,-71.0959083715027,-71.7628835,-70.9450945705336,-72.165386,-71.2005241,-72.47222226666079,-71.8119837,-71.77070019999999,-70.4811383,-71.22789736306839,-71.76497519999999,-71.21908334877379,-71.144086,-71.11113,-70.9669902070805,-71.1460783680883,-71.4173664642241,-71.2358004,-72.5567226328951,-70.2735221923483,-71.98748072431211,-71.0183787,-71.8989161675468,-71.0971892712258,-70.8440854,-71.14686279999999,-72.47288272264809,-70.8801,-71.0768393856917,-70.9311385196367,-71.5940930809949,-71.5741458734304,-71.0086144242722,-71.7661469251106,-70.982827,-71.51639128815469,-70.7191143173718,-71.2005241,-71.2799609175534,-70.50221500000001,-70.18292625685081,-72.5324710720398,-71.0746295151461,-70.9458998765494,-71.0951812135179,-70.94967338146699,-70.8909164574759,-70.8710822425041,-72.55261320852939,-71.80521,-70.97106354209529,-71.27520816952971,-70.8909164574759,-71.1684508,-71.1125410206286,-70.91715069999999,-71.0924311,-71.0907694493843,-71.15227659999999,-71.064182,-71.26188860000001],10,null,null,{"interactive":true,"className":"","stroke":true,"color":["purple","purple","blue","purple","purple","purple","purple","yellow","yellow","yellow","green","purple","yellow","purple","purple","green","purple","yellow","orange","purple","purple","blue","purple","purple","blue","blue","purple","orange","purple","purple","red","purple","blue","purple","purple","purple","purple","purple","purple","blue","purple","purple","blue","blue","purple","yellow","purple","blue","purple","purple","blue","blue","purple","purple","purple","purple","green","purple","purple","purple","purple","blue","orange","purple","blue","green","red","blue","purple","purple","blue","purple","yellow","purple","orange","purple","green","purple","purple","yellow","green","purple","purple","purple","orange","purple","yellow","yellow","yellow","purple","blue","blue","yellow","yellow","blue","yellow","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","yellow","blue","yellow","yellow","yellow","yellow","yellow","blue","yellow","blue","blue","red","yellow","yellow","yellow","yellow","green","yellow","yellow","yellow","yellow","yellow","yellow","green","yellow","green","blue","purple","blue","blue","yellow","yellow","purple","yellow","yellow","blue","yellow","blue","blue","yellow","yellow","yellow","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","yellow","yellow","red","yellow","yellow","yellow","red","yellow","yellow","yellow","green","yellow","blue","yellow","yellow","blue","yellow","yellow","blue","yellow","blue","yellow","yellow","yellow","blue","red","yellow","yellow","blue","blue","yellow","yellow","yellow","yellow","red","yellow","blue","yellow","blue","yellow","yellow","yellow","yellow","purple","green","blue","yellow","yellow","yellow","yellow","yellow","yellow","purple","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","green","yellow","yellow","yellow","purple","yellow","green","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","blue","blue","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","yellow","green","yellow","green","yellow","yellow","yellow","blue","yellow","green","yellow","blue","yellow","blue","yellow","yellow","blue","yellow","yellow","yellow","yellow","yellow","yellow","blue","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","blue","yellow","yellow","blue","yellow","yellow","yellow","orange","purple","yellow","yellow","yellow","yellow","yellow","blue","blue","yellow","yellow","red"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["purple","purple","blue","purple","purple","purple","purple","yellow","yellow","yellow","green","purple","yellow","purple","purple","green","purple","yellow","orange","purple","purple","blue","purple","purple","blue","blue","purple","orange","purple","purple","red","purple","blue","purple","purple","purple","purple","purple","purple","blue","purple","purple","blue","blue","purple","yellow","purple","blue","purple","purple","blue","blue","purple","purple","purple","purple","green","purple","purple","purple","purple","blue","orange","purple","blue","green","red","blue","purple","purple","blue","purple","yellow","purple","orange","purple","green","purple","purple","yellow","green","purple","purple","purple","orange","purple","yellow","yellow","yellow","purple","blue","blue","yellow","yellow","blue","yellow","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","yellow","blue","yellow","yellow","yellow","yellow","yellow","blue","yellow","blue","blue","red","yellow","yellow","yellow","yellow","green","yellow","yellow","yellow","yellow","yellow","yellow","green","yellow","green","blue","purple","blue","blue","yellow","yellow","purple","yellow","yellow","blue","yellow","blue","blue","yellow","yellow","yellow","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","yellow","yellow","red","yellow","yellow","yellow","red","yellow","yellow","yellow","green","yellow","blue","yellow","yellow","blue","yellow","yellow","blue","yellow","blue","yellow","yellow","yellow","blue","red","yellow","yellow","blue","blue","yellow","yellow","yellow","yellow","red","yellow","blue","yellow","blue","yellow","yellow","yellow","yellow","purple","green","blue","yellow","yellow","yellow","yellow","yellow","yellow","purple","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","yellow","green","yellow","yellow","yellow","purple","yellow","green","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","blue","blue","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","yellow","green","yellow","green","yellow","yellow","yellow","blue","yellow","green","yellow","blue","yellow","blue","yellow","yellow","blue","yellow","yellow","yellow","yellow","yellow","yellow","blue","blue","yellow","yellow","yellow","yellow","yellow","yellow","yellow","blue","yellow","blue","yellow","yellow","blue","yellow","yellow","yellow","orange","purple","yellow","yellow","yellow","yellow","yellow","blue","blue","yellow","yellow","red"],"fillOpacity":0.2},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[41.61112,42.8173801],"lng":[-73.2492795834909,-70.18292625685081]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>